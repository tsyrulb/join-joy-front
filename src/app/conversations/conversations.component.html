<div class="conversations-container">
  <!-- Conversations List -->
  <div class="conversation-list">
    <!-- Search Bar -->
    <div class="search-bar">
      <input
        type="text"
        class="form-control"
        placeholder="Search conversations..."
        [(ngModel)]="searchQuery"
        (input)="filterConversations()"
      />
    </div>

    <ul>
      <li
        *ngFor="let conversation of filteredConversations"
        (click)="loadMessagesForConversation(conversation.id)"
        [class.selected]="conversation.id === selectedConversationId"
      >
        <div class="conversation-participants">
          <p>
            <span class="participant-names">
              <ng-container
                *ngFor="
                  let participant of conversation.participants.slice(
                    0,
                    getMaxVisibleParticipants()
                  );
                  let isLast = last
                "
              >
                {{ participant.user.name }}
                <span
                  *ngIf="
                    !isLast &&
                    participant !==
                      conversation.participants[getMaxVisibleParticipants() - 1]
                  "
                  >,
                </span>
              </ng-container>
              <span
                *ngIf="
                  conversation.participants.length > getMaxVisibleParticipants()
                "
                >...</span
              >
            </span>
          </p>
        </div>
      </li>
    </ul>
  </div>

  <!-- Messages Window -->
  <div class="messages-window" *ngIf="selectedConversationId">
    <app-messages
      [conversationId]="selectedConversationId"
      [participants]="participants"
      [messages]="filteredMessages"
      [conversationTitle]="conversationTitle"
    ></app-messages>
  </div>
</div>
